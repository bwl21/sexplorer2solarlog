<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
</head>
<body>
<div id="TOC">
<ul>
<li><a href="#einf&#252;hrung"><span class="toc-section-number">1</span> Einf&#252;hrung</a></li>
<li><a href="#eigenschaften"><span class="toc-section-number">2</span> Eigenschaften</a></li>
<li><a href="#installation"><span class="toc-section-number">3</span> Installation</a><ul>
<li><a href="#download"><span class="toc-section-number">3.1</span> Download</a></li>
<li><a href="#installkit-auspacken"><span class="toc-section-number">3.2</span> Installkit auspacken</a></li>
<li><a href="#konfigurationsdateien-anpassen"><span class="toc-section-number">3.3</span> Konfigurationsdateien anpassen</a><ul>
<li><a href="#base_vars.js"><span class="toc-section-number">3.3.1</span> base_vars.js</a><ul>
<li><a href="#beispiele-zur-base_vars.js"><span class="toc-section-number">3.3.1.1</span> Beispiele zur base_vars.js:</a></li>
</ul></li>
</ul></li>
<li><a href="#hinweise-zur-verzeichnisstruktur-und-den-pfadangaben-in-den-config-dateien"><span class="toc-section-number">3.4</span> Hinweise zur Verzeichnisstruktur und den Pfadangaben in den config-Dateien</a><ul>
<li><a href="#einstellungen-in-der-datei-config.danfoss.php"><span class="toc-section-number">3.4.1</span> Einstellungen in der Datei <code>config.danfoss.php</code></a></li>
<li><a href="#einstellungen-in-der-datei-config.solarlog.php"><span class="toc-section-number">3.4.2</span> Einstellungen in der Datei &#8220;config.solarlog.php&#8221;</a></li>
</ul></li>
</ul></li>
<li><a href="#generelle-anmerkungen"><span class="toc-section-number">4</span> Generelle Anmerkungen</a></li>
</ul>
</div>
<h1 id="einf&#252;hrung"><a href="#TOC"><span class="header-section-number">1</span> Einf&#252;hrung</a></h1>
<p>Kurze Hilfestellung zur Einrichtung der Datenkonvertierung von Datendateien diverser Wechselrichter in Solarlog-Dateien zum Darstellen auf einer Solarlog-Homepage.</p>
<h1 id="eigenschaften"><a href="#TOC"><span class="header-section-number">2</span> Eigenschaften</a></h1>
<p><em>InverterData2SolarLog</em> unterst&#252;tzt folgende Wechselrichter</p>
<ul>
<li>SolarExplorer von SMA</li>
<li>Danfoss Triply Lynx</li>
</ul>
<h1 id="installation"><a href="#TOC"><span class="header-section-number">3</span> Installation</a></h1>
<ol style="list-style-type: decimal">
<li>Download</li>
<li>Installkit auspacken</li>
<li>Konfigrationsdateien anpassen</li>
<li>Kit lokal austesten</li>
<li>Kit auf Werbserver kopieren</li>
</ol>
<h2 id="download"><a href="#TOC"><span class="header-section-number">3.1</span> Download</a></h2>
<p>Die Datei <strong><em>links.html</em></strong> aus dem Homepagekit von Solare Datensysteme bitte durch die Datei <strong><em>links.html</em></strong> ersetzen, die im Paket im Verzeichnis <strong><em>SolarLog</em></strong> enthalten ist.</p>
<p>Das Homepagekit kann bei <a href="http://www.solar-log.com/de/service-support/downloads/homepagekit.html">SolarLog</a> herunter geladen werden. Bitte die <a href="http://www.solar-log.com/fileadmin/BENUTZERDATEN/Downloads/Homepage/SolarLog-Homepage2.5.0-INT.zip">Version 2.5.0</a> verwenden!</p>
<p>Das Paket mit den Scripten kann [hier][InverterData2SolarLog-Download] heruntergeladen werden.</p>
<p>Hinweise in letzter Minute, die noch nicht in diese Seite eingearbeitet wurden, gibt es <a href="http://photonensammler.homedns.org/Danfoss2solarlog/Hinweise.txt">hier</a>.</p>
<h2 id="installkit-auspacken"><a href="#TOC"><span class="header-section-number">3.2</span> Installkit auspacken</a></h2>
<p>Vor der Inbetriebnahme der Homepage ist die Datei <code>base_vars.js</code> zu erstellen (falls sie noch nicht vorhanden ist) und anzupassen!!!</p>
<h2 id="konfigurationsdateien-anpassen"><a href="#TOC"><span class="header-section-number">3.3</span> Konfigurationsdateien anpassen</a></h2>
<h3 id="base_vars.js"><a href="#TOC"><span class="header-section-number">3.3.1</span> base_vars.js</a></h3>
<p>Wenn die Scripte einmal fehlerfrei durchgelaufen sind, wird eine Datei <code>base_vars.js</code> erstellt falls sie noch nicht vorhanden. Sie enth&#228;lt dann aber nur Eintr&#228;ge, die durch die Scripte ver&#228;ndert und aktualisiert werden. Ist diese Datei schon vorhanden, werden nur die Eintr&#228;ge angepasst.</p>
<p>Die folgenden Eintr&#228;ge in der <code>base_vars.js</code> m&#252;ssen deshalb nicht beachtet, ver&#228;ndert oder eingef&#252;gt werden:</p>
<pre><code>var SLTyp = 
var DATALOGGER_NAME = 
var Firmware = 
var isOnline = 
var SLDatum = 
var SLUhrzeit = </code></pre>
<p>Sie werden von den PHP-Scripten geschrieben!!!</p>
<p>Die folgenden Eintr&#228;ge sind unbedingt anzupassen:</p>
<ul>
<li><p><code>var AnlagenKWP = 7000</code></p>
<p>Gesamtleistung der Anlage in Watt (Summe aller angeschlossenen Modulleistungen)</p></li>
<li><p><code>var AnzahlWR = 1</code></p>
<p>Anzahl Wechselrichter.</p></li>
<li><p><code>MaxWRP[0] = new Array(xxxx,xxxxx,xxxxxx,xxxxxx)</code></p>
<p>F&#252;r jeden WR ist so eine Zeile erforderlich. Bei zwei WR gibt es deshalb z.B. noch eine Zeile</p>
<p><code>MaxWRP[1] = ...</code></p>
<p>Die Bedeutung der Werte bitte <a href="http://photonensammler.homedns.org/SL-Umzug/Solarlog-Datenformat/">ddd</a> entnehmen.</p></li>
<li><p><code>WRInfo[0] = new Array(&#8220;Danfoss TLX PRO 6k&#8221;, ...)</code></p>
<p>F&#252;r jeden WR ist so eine Zeile erforderlich. Bei zwei WR gibt es deshalb z.B. noch eine Zeile</p>
<pre><code>  WRInfo[0] = new Array(&#8220;Danfoss TLX PRO 6k&#8221;, &#8220;1111111111&#8221;, 7000, 
                        0, &#8220;Danfoss&#8221;, 2, null, null, 6000, 
                        null, 12, 0, 1, 1000)

  WRInfo[1] = &#8230;&#8230;.. </code></pre>
<p>Die Bedeutung der Werte bitte <a href="http://photonensammler.homedns.org/SL-Umzug/Solarlog-Datenformat/">Solarlog-Datenformat</a> entnehmen.</p></li>
<li><p><code>WRInfo[0][6] = new Array(&#8220;String1&#8221;,&#8220;String2&#8221;)</code></p>
<p>Wenn an den WR mehrere Strings angeschlossen sind, ist f&#252;r jeden WR eine solche Zeile erforderlich.</p>
<p>Die Bedeutung der Werte bitte <a href="http://photonensammler.homedns.org/SL-Umzug/Solarlog-Datenformat/">Solarlog-Datenformat</a> entnehmen.</p></li>
<li><p><code>WRInfo[0][7] = new Array(1,1)</code></p>
<p>Wenn an den WR mehrere Strings angeschlossen sind, ist f&#252;r jeden WR eine solche Zeile erforderlich.</p>
<p>Die Bedeutung der Werte bitte <a href="http://photonensammler.homedns.org/SL-Umzug/Solarlog-Datenformat/">Solarlog-Datenformat</a> entnehmen.</p></li>
<li><p><code>WRInfo[0][9] = new Array(3500,3500)</code></p>
<p>Wenn an den WR mehrere Strings angeschlossen sind, ist f&#252;r jeden WR eine solche Zeile erforderlich.</p>
<p>Die Bedeutung der Werte bitte <a href="http://photonensammler.homedns.org/SL-Umzug/Solarlog-Datenformat/">Solarlog-Datenformat</a> entnehmen.</p></li>
<li><p><code>var HPTitel = &#8220;Name meiner Hoepage&#8221;</code></p>
<p>In Anf&#252;hrungszeichen eingeschlossen.</p></li>
<li><p><code>var HPBetreiber = &#8220;Name des Anlagenbetreibers&#8221;</code></p>
<p>In Anf&#252;hrungszeichen eingeschlossen.</p></li>
<li><p>'var HPEmail = &#8220;Email des Betreibers&#8221;`</p>
<p>In Anf&#252;hrungszeichen eingeschlossen.</p></li>
<li><p><code>var HPStandort = &#8220;Standort der Anlage&#8221;</code></p>
<p>In Anf&#252;hrungszeichen eingeschlossen.</p></li>
<li><p><code>var HPModul = &#8220;Anzahl und Typ der Solarmodule&#8221;</code></p>
<p>In Anf&#252;hrungszeichen eingeschlossen.</p></li>
<li><p><code>var HPWR = &#8220;WR-Typ und Bezeichnung&#8221;</code></p>
<p>In Anf&#252;hrungszeichen eingeschlossen.</p></li>
<li><p><code>var HPLeistung = &#8220;Anlagenleistung&#8221;</code></p>
<p>In Anf&#252;hrungszeichen eingeschlossen.</p></li>
<li><p><code>HPInbetrieb = &#8220;Inbetriebnahmedatum der Anlage&#8221;</code></p>
<p>In Anf&#252;hrungszeichen eingeschlossen.</p></li>
<li><p><code>var HPAusricht = &#8220;Ausrichtung der Anlage&#8221;</code></p>
<p>In Anf&#252;hrungszeichen eingeschlossen.</p></li>
<li><p><code>var BannerZeile1 = &#8220;beliebiger Wert f&#252;r Banner&#8221;</code></p>
<p>In Anf&#252;hrungszeichen eingeschlossen.</p></li>
<li><p><code>var BannerZeile2 = &#8220;beliebiger Wert f&#252;r Banner&#8221;</code></p>
<p>In Anf&#252;hrungszeichen eingeschlossen.</p></li>
<li><p><code>var BannerZeile3 = &#8220;beliebiger Wert f&#252;r Banner&#8221;</code></p>
<p>In Anf&#252;hrungszeichen eingeschlossen.</p></li>
<li><p><code>var BannerLink = &#8220;http://www&#8230;&#8230;&#8230;&#8230;./banner.html&#8221;</code></p>
<p>URL auf die Datei banner.html, die sich im Solarlog-Verzeichnis befindet.</p>
<p>In Anf&#252;hrungszeichen eingeschlossen.</p></li>
<li><p><code>StatusCodes[0] = &#8220;Off|MPP&#8221;</code></p>
<p>Hier werden die zwei m&#246;glichen Status-Zust&#228;nde des jeweiligen WR eingetragen (Zustand Off und MPP).</p>
<p>Die Zeile muss f&#252;r jeden WR enthalten sein (analog <em>MaxWRP[x]</em> und <em>WRInfo[x]</em>, siehe weiter oben in dieser Tabelle).</p>
<p>Wer die Werte &#8220;&#252;bersetzen&#8221; m&#246;chte, kann hier auch gern &#8220;Aus,An&#8221; eintragen.</p>
<p>In Anf&#252;hrungszeichen eingeschlossen.</p></li>
<li><p><code>FehlerCodes[0] = &quot; &quot;</code></p>
<p>Der Inhalt dieser Werte ist gleichg&#252;ltig weil Danfoss-WR keinen Fehlercode ausgeben. Die Zeile muss lediglich f&#252;r jeden WR enthalten sein (analog <em>MaxWRP[x]</em> oder <em>WRInfo[x]</em>, siehe weiter oben in dieser Tabelle).</p>
<p>In Anf&#252;hrungszeichen eingeschlossen.</p></li>
<li><p><code>var Verguetung =</code></p>
<p>Verg&#252;tung pro kWh in &#8364;Cent * 100</p>
<p>Beispiel: 21,54 Cent/kWh =&gt; Eintrag <code>2154</code></p></li>
<li><p><code>var WRTyp = &#8220;Danfoss&#8221;</code></p>
<p>Beliebiger Eintrag des WR-Types.</p>
<p>In Anf&#252;hrungszeichen eingeschlossen.</p></li>
<li><p><code>var SLVer = 2</code></p>
<p>Hier muss 2 eingetragen sein!</p></li>
<li><p><code>var Intervall = 600</code></p>
<p>Hier ist unbedingt das Intervall in Sekunden einzutragen, in dem der WR seine Daten liefert!</p>
<p>Es handelt sich dabei nicht um das Upload-Intervall neuer Daten-Dateien, sondern das Intervall, mit dem die Ertragswerte in den Datendateien gespeichert werden.</p>
<p>Beispiel:</p>
<pre><code>10 Minuten =&gt; 600
 5 Minuten =&gt; 300
 1 Minute =&gt; 60</code></pre></li>
<li><p><code>var isTemp = true | false</code></p>
<p><em>true</em> wenn die WR-Temperatur in den gelieferten Daten vorhanden ist (bei Danfoss WR der Fall).</p>
<p><em>false</em> wen die WR-Temperatur nicht vorhanden ist.</p></li>
<li><p><code>var eventsHP = 0</code></p>
<p>Ist bei Danfoss-WR auf 0 zu stellen !!!</p></li>
<li><p><code>var Lang = &#8220;DE&#8221;</code></p>
<p>Sprache, in der die SL-Seite angezeigt werden soll (siehe im Solarlog-Verzeichnis Dateien <code>lang_XX.js</code>).</p></li>
<li><p><code>var Lang = &#8220;DE&#8221;</code> f&#252;r die Deutsche Seite.</p></li>
<li><p><code>var FirmwareDate = &#8220;23.03.2012&#8221;</code></p>
<p>Dieser Eintrag muss ein g&#252;ltiges Datum enthalten, es darf nicht zu alt sein !!!</p>
<p>Der Wert ist ist dabei fast beliebig w&#228;hlbar, ich empfehle, den 23.03.2012 oder sp&#228;ter zu &#252;bernehmen.</p></li>
</ul>
<h4 id="beispiele-zur-base_vars.js"><a href="#TOC"><span class="header-section-number">3.3.1.1</span> Beispiele zur base_vars.js:</a></h4>
<ul>
<li><p>Ein WR mit 2 Strings ohne WR-Temperatur (Standard Solarlog 100e)</p>
<p><a href="http://photonensammler.homedns.org/SLDaten/base_vars.js">http://photonensammler.homedns.org/SLDaten/base_vars.js</a></p></li>
<li><p>Emulation (auch von mir geschrieben) 2 WR, einer mit 5 Strings, einer mit 4 Strings ohne WR-Temperatur</p>
<p><a href="http://helios64.dyndns.org/base_vars.js">http://helios64.dyndns.org/base_vars.js</a></p>
<p>Hier kann man gut sehen, wie mehrere Strings in der <code>Base_vars.js</code> zu definieren sind.</p></li>
<li><p>Ein Danfoss-WR mit 2 Strings und WR-Temperatur (Emulation aus diesem Paket):</p>
<p><a href="http://www.lykkegaarden.eu/lykkegaarden/base_vars.js">http://www.lykkegaarden.eu/lykkegaarden/base_vars.js</a></p>
<p>Eine Beschreibung des Solarlog-Datenformats findet sich <a href="http://photonensammler.homedns.org/SL-Umzug/Solarlog-Datenformat/">Solarlog-Datenformat</a>.</p>
<p>Die Datei base_vars.js hat keinen Einfluss auf das Funktionieren der Konvertierungsscripte.</p>
<p>Sollen erst einmal testweise die Solarlog-Dateien erstellt werden, ist diese Datei nicht erforderlich.</p>
<p>Sie ist aber erforderlich wenn die erzeugten Daten sp&#228;ter auf der Internetseite angezeigt werden sollen.</p></li>
</ul>
<h2 id="hinweise-zur-verzeichnisstruktur-und-den-pfadangaben-in-den-config-dateien"><a href="#TOC"><span class="header-section-number">3.4</span> Hinweise zur Verzeichnisstruktur und den Pfadangaben in den config-Dateien</a></h2>
<ul>
<li><p>Unter UNIX-Systemen ist bei den Pfadangaben und Dateinamen auf Gro&#223;- und Kleinschreibung zu achten!!!</p>
<p>Ich schlage die Verwendung einer Verzeichnisstruktur vor, an die man nicht gebunden ist, die aber die erste Einrichtung der Scripte erleichtern kann:</p>
<p>//[Verzeichnisstruktur] (index-Dateien/image003.jpg)</p></li>
<li><p>Das Verzeichnis xx dient nur der besseren Veranschaulichung wie die Hierarchie der Verzeichnisse aussieht, es hat keinen Einfluss auf die Funktion, kann auch weggelassen oder umbenannt werden.</p></li>
<li><p>In &#8220;InverterData&#8221; legt der Wechselrichter seine Datendateien ab, die sp&#228;ter in Solarlog-Daten konvertiert werden sollen.</p></li>
<li><p>In &#8220;SolarLog&#8221; werden die heruntergeladenen Dateien der Solarlog-Homepage gespeichert. Auf dieses Verzeichnis (auf <code>index.html</code>) verweist auch die URL, &#252;ber die sp&#228;ter die Seite angezeigt wird. In diesem Verzeichnis werden auch die erzeugten SL-Dateien abgelegt.</p></li>
<li><p>In Danfoss2SolarLog muss sich das Verzeichnis &#8220;Classes&#8221; mit den darin befindlichen PHP-Dateien befinden!!! Weiterhin m&#252;ssen sich dort die 3 &#8220;config.xxxx.php&#8221; Dateien und das Script &#8220;update.php&#8221; befinden.</p>
<p>Das Script &#8220;update.php&#8221; kann zum Testen der Funktion der Konvertierung von Hand gestartet werden. Sp&#228;ter wird es durch einen eingerichteten Cronjob gestartet, der abh&#228;ngig von der Zeit zu der der WR neue Daten liefert, automatisch ausgef&#252;hrt wird.</p></li>
<li><p>Ich empfehle, das Verzeichnis &#8220;errors&#8221; an seinem vorgeschlagenen Platz zu belassen.</p>
<p>&#196;nderungen sind durch Editieren der &#8220;config.general.php&#8221; m&#246;glich. In diesem Verzeichnis wird bei Scriptfehlern eine Datei &#8220;errors.txt&#8221; erzeugt, in der aufgetretene Fehlermeldungen geloggt werden.</p>
<p>Diese Datei kann gel&#246;scht werden, sie wird bei Scriptfehlern automatisch neu erzeugt.</p></li>
<li><p>Die Voreinstellungen in den &#8220;config.xxxx.php&#8221; Dateien beziehen sich auf die oben angegebene Verzeichnisstruktur. Wird diese Struktur verwendet, sind damit nur wenige Anpassungen in den Konfigurationsdateien erforderlich.</p></li>
</ul>
<h3 id="einstellungen-in-der-datei-config.danfoss.php"><a href="#TOC"><span class="header-section-number">3.4.1</span> Einstellungen in der Datei <code>config.danfoss.php</code></a></h3>
<p>Die Einstellungen in der Datei sind kommentiert. Zeilen, die mit <code>//</code> beginnen, oder Abschnitte, die in <code>/\* \*/</code> eingeschlossen sind, sind Kommentare.</p>
<p><code>define-Eintr&#228;ge</code>, die ge&#228;ndert werden und schon im Beispiel durch Anf&#252;hrungszeichen eingeschlossen sind, m&#252;ssen wieder durch Anf&#252;hrungszeichen eingeschlossen werden!!!</p>
<ul>
<li><p><code>define(&#8217;USE_FTP&#8217;,false);</code></p>
<p><strong>false</strong>: wenn die Scripte die zu konvertierenden Datendateien des WR aus einem <em>lokalen Verzeichnis</em> beziehen.</p>
<p><strong>true</strong>: WR-Datendateien sollen von einem <em>FTP-Server</em> geholt werden</p></li>
<li><p><code>define(&#8217;FTP_SERVER&#8217;, &#8216;ftp.myftpserver.com&#8217;);</code></p>
<p>Eintrag ist nur relevant wenn <strong><em>USE_FTP</em></strong> auf <strong><em>true</em></strong> steht:</p>
<p>Hier wird der FTP-Server eingetragen, von dem die Scripte die WR-Datendateien laden sollen.</p></li>
<li><p><code>define(&#8217;FTP_USERNAME&#8217;, &#8216;myFTPUsername&#8217;);</code></p>
<p>Eintrag ist nur relevant wenn <strong><em>USE_FTP</em></strong> auf <strong><em>true</em></strong> steht:</p>
<p>Hier wird der Username zum Zugriff auf den FTP-Server eingetragen.</p></li>
<li><p><code>define(&#8217;FTP_PASSWORD&#8217;, &#8216;MyFTPPassword&#8217;);</code></p>
<p>Eintrag ist nur relevant wenn <strong><em>USE_FTP</em></strong> auf <strong><em>true</em></strong> steht:</p>
<p>Hier wird das Passwort zum Zugriff auf den FTP-Server eingetragen.</p></li>
<li><p><code>define(&#8217;FTP_PORT&#8217;, 21);</code></p>
<p>Eintrag ist nur relevant wenn <strong><em>USE_FTP</em></strong> auf <strong><em>true</em></strong> steht:</p>
<p>FTP-Port &#8211; in der Regel 21, Eintrag muss normalerweise nicht ver&#228;ndert werden.</p></li>
<li><p><code>*define(&#8217;FTP_TIMEOUT&#8217;, 90);</code></p>
<p>Eintrag ist nur relevant wenn <strong><em>USE_FTP</em></strong> auf <strong><em>true</em></strong> steht:</p>
<p>Timeout der FTP-Verbindung in Sekunden.</p>
<p>Standardwert ist 90 Sekunden. Ist die FTP-Verbindung sehr langsam wodurch es &#246;fter zu Abbr&#252;chen kommt, kann dieser Wert erh&#246;ht werden.</p></li>
<li><p><code>define(&#8217;FTP_INVERTER_DATA_PATH&#8217;, &#8217;.&#8217;);</code></p>
<p>Eintrag ist nur relevant wenn <strong><em>USE_FTP</em></strong> auf <strong><em>true</em></strong> steht:</p>
<p>Befinden sich die WR-Datendateien nicht im Root-Verzeichnis des FTP-Servers, kann hier das FTP-Verzeichnis eingetragen werden, in dem sich die Dateien befinden.</p>
<p>F&#252;r das FTP-Root-Verzeichnis ist der Eintrag</p>
<p>define('FTP_INVERTER_DATA_PATH', '.')</p></li>
<li><p><code>define(&#8217;LOCAL_TEMP_DIR&#8217;, &#8217;.&#8217;);</code></p>
<p>Eintrag ist nur relevant wenn <strong><em>USE_FTP</em></strong> auf <strong><em>true</em></strong> steht:</p>
<p>Die WR-Datendateien m&#252;ssen beim Download per FTP irgendwo lokal zwischengespeichert werden. Hier ist ein Verzeichnis einzutragen, auf das die Scripte Schreibrechte haben und wo die Daten gespeichert werden k&#246;nnen.</p>
<p>Bei der Einstellung <code>define(&#8217;LOCAL_TEMP_DIR&#8217;, null);</code> wird das Temp-Verzeichnis des Systems ermittelt und die Daten dort zwischengespeichert.</p>
<p>Nach der Verarbeitung der Daten werden die Dateien wieder gel&#246;scht.</p></li>
<li><p><code>define(&#8217;LOCAL_TEMP_DIR&#8217;, &#8217;.&#8217;);</code></p>
<p>Eintrag ist nur relevant wenn <strong><em>USE_FTP</em></strong> auf <strong><em>false</em></strong> steht:</p>
<p>Hier ist das Verzeichnis einzutragen, in dem sich die WR-Datendateien befinden, wenn sie auf dem lokalen Rechner vorliegen und nicht per FTP geholt werden.</p>
<p>Der anzugebende Verzeichnispfad ist relativ zum Verzeichnis, in dem sich update.php befindet, anzugeben.</p></li>
<li><p><code>define(&#8217;USED_STRINGS_1&#8217;, &#8216;1,2&#8217;);</code></p>
<p><strong>Dieser Wert ist immer zu konfigurieren!!!</strong></p>
<p>F&#252;r jeden WR ist dieser Eintrag einmal vorhanden. Es ist anzugeben, welcher String des WR belegt ist.</p>
<p>Beispiele:</p>
<pre><code>   define(&#8217;USED_STRINGS_1&#8217;, &#8216;1,2&#8217;); WR1 benutzt String 1 und 2        
   define(&#8217;USED_STRINGS_1&#8217;, &#8216;1,2,3&#8217;); WR1 benutzt String 1,2 und 3 
   define(&#8217;USED_STRINGS_2&#8217;, &#8216;1,3&#8217;); WR2 benutzt String 1 und 3</code></pre></li>
<li><p><code>define(&#8217;DANFOSS_PLANT_NAME&#8217;, &#8216;u43381201-1&#8217;);</code></p>
<p><strong>Dieser Wert ist immer zu konfigurieren!!!</strong></p>
<p>Hier ist der Name der WR-Datendateien einzutragen. Dabei wird er ohne den letzten &#8220;-&#8221; vor dem Timestamp, der den Dateinamen abschlie&#223;t, einzutragen.</p>
<p>Im Beispiel hei&#223;en die WR-Dateien <em>u43381201-1-xxxxxxxxxxxx</em></p></li>
<li><p><code>define(&#8217;DELIMITER&#8217;, &#8217;;&#8217;);</code></p>
<p>Dieser Wert muss in der Regel nicht ver&#228;ndert werden.</p></li>
</ul>
<h3 id="einstellungen-in-der-datei-config.solarlog.php"><a href="#TOC"><span class="header-section-number">3.4.2</span> Einstellungen in der Datei &#8220;config.solarlog.php&#8221;</a></h3>
<ul>
<li><p><code>define(&#8217;SLFILE_DATA_PATH&#8217;, &#8217;../SolarLog&#8217;);</code></p>
<p>Hier ist das Verzeichnis einzutragen, in dem die Scripte die konvertierten Solarlog-Dateien ablegen sollen.</p>
<p>Diese Eintragung zeigt auf das Verzeichnis, in dem sich die Homepage aus dem Homepage-Kit befindet.</p>
<p>Das Benutzer unter dem das Script l&#228;uft, ben&#246;tigt f&#252;r dieses Verzeichnis Schreibrechte.</p></li>
</ul>
<h1 id="generelle-anmerkungen"><a href="#TOC"><span class="header-section-number">4</span> Generelle Anmerkungen</a></h1>
<ul>
<li><p>Alle Verzeichnisangaben beziehen sich relativ auf das Verzeichnis, in dem sich update.php befindet.</p>
<p>Wer genau wei&#223; was er tut, kann selbstverst&#228;ndlich auch absolute Verzeichnispfade angeben.</p></li>
<li><p>Alle Verzeichnisnamen sind ohne abschlie&#223;ende Schr&#228;gstriche anzugeben.</p></li>
<li><p>Trennungen innerhalb der Pfade sind durch den Schr&#228;gstrich &#8220;/&#8221; vorzunehmen.</p></li>
<li><p>Um die Solarlog-Dateien zu erzeugen, ist das Script <code>update.php</code> zu starten.</p></li>
<li><p>Dies geschieht am besten mittels Cronjob, dessen Startintervall an das Uploadintervall der WR angepasst wird.</p></li>
<li><p><strong>Achtung:</strong> Beim allerersten Start (zum Testen von nat&#252;rlich Hand) kann die Zeit der Abarbeitung etwas l&#228;nger sein weil erst einmal s&#228;mtliche vorhandenen Altdaten der WR verarbeitet werden. W&#228;hrend der Zeit der Abarbeitung kann im Solarlog-Verzeichnis das Entstehen der einzelnen Solarlog-Dateien beobachtet werden.</p></li>
<li><p>Wenn die Solarlog-Dateien erst einmal erzeugt sind, geht jede weitere Abarbeitung schneller weil nur noch ge&#228;nderte Daten gelesen werden m&#252;ssen.</p></li>
<li><p>Das Script update.php nur einmal starten!!!! Mehrfaches gleichzeitiges Abarbeiten f&#252;hrt unweigerlich zu Fehlern wenn das zuerst gestartete Script noch l&#228;uft!!!!</p></li>
<li><p>Sollten auf Grund falscher Einstellungen in den config-Dateien fehlerhafte Solarlog-Dateien erzeugt werden oder die Scriptabarbeitung wegen anderer Fehler abgebrochen werden, ist vor einem erneuten Starten zu pr&#252;fen, ob schon SL-Dateien erzeugt wurden.</p>
<p>Diese sind vor dem erneuten Starten zu l&#246;schen!!!!! Die SL-Dateien sind erst vollst&#228;ndig und fehlerfrei wenn update.php einmal fehlerfrei abgearbeitet wurde.</p>
<p>Es werden folgende SL-Dateien im Solarlog-Verzeichnis erzeugt, die vor erneutem Scriptstart gel&#246;scht werden m&#252;ssen:</p>
<ul>
<li><code>min_day.js</code> - diese Datei unbedingt l&#246;schen, sie steuert den gesamten Scriptablauf</li>
<li><code>days.js</code></li>
<li><code>days_hist.js</code></li>
<li><code>min_cur.js</code></li>
<li><code>months.js</code></li>
<li><code>years.js</code></li>
<li><code>minYYMMDD.js</code> mit <code>YY</code>=Jahr <code>MM</code>=Monat <code>DD</code>=Tag</li>
</ul></li>
<li><p>Je nachdem, wie weit das Script beim Abarbeiten war bis ein Fehler auftrat, kann es sein, dass noch nicht alle o.g. SL-Dateien erzeugt wurden.</p></li>
<li><p>Die Scripte befinden sich noch im Beta-Stadium - ich &#252;bernehme keine Gew&#228;hrleistung, dass sie schon auf jedem System fehlerfrei funktionieren!!!</p></li>
<li><p>Sie wurden bisher nur mit einem WR getestet. Ich &#252;bernehme keine Gew&#228;hr, dass sie auch mit mehreren WR funktionieren (obwohl das durchaus m&#246;glich sein k&#246;nnte und bei der Programmierung &#8211; soweit m&#246;glich &#8211; auch schon ber&#252;cksichtigt wurde).</p></li>
</ul>
<p>%<a href="https://www.paypalobjects.com/de_DE/i/scr/pixel.gif"></a></p>
<p><strong>Viel Erfolg!</strong> J&#246;rg</p>
<p>![] (/statistik/pphlogger.php?id=photonensammler&amp;st=img)</p>
<p>![] (/piwik/piwik.php?idsite=1)</p>
<p>[InverterData2SolarLog-Download]: [http://photonensammler.homedns.org/Danfoss2solarlog/DownloadPaket/]</p>
</body>
</html>
